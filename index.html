<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TSAS Admin Panel</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light p-4">

    <div class="container col-lg-7 col-md-9 col-12">

        <h2 class="mb-3 fw-bold">TSAS Admin Panel</h2>
        <p class="text-muted">
            Upload notices, Links and announcements. 
            <b>Date & time are added automatically.</b>
        </p>

        <!-- ==================== NOTICE UPLOAD ==================== -->
        <h4 class="mt-4">Upload Notice</h4>
        <div class="card p-4 shadow-sm mb-5">
            <form id="noticeForm" enctype="multipart/form-data">

                <div class="mb-3">
                    <label class="form-label">Notice Title</label>
                    <input type="text" class="form-control" name="title" required>
                </div>

                <div class="mb-3">
                    <label class="form-label">Upload File (PDF / Image)</label>
                    <input type="file" class="form-control" name="file" required>
                </div>

                <button class="btn btn-primary w-100" type="submit">
                    Upload Notice
                </button>
            </form>
        </div>

        <div id="notice-result"></div>

        <!-- ==================== ANNOUNCEMENT UPLOAD ==================== -->
        <h4 class="mt-4">Upload Announcement</h4>
        <div class="card p-4 shadow-sm mb-5">
            <form id="announcementForm">

                <div class="mb-3">
                    <label class="form-label">Announcement Text</label>
                    <input type="text" class="form-control" name="title" required>
                </div>

                <button class="btn btn-warning w-100">
                    Upload Announcement
                </button>
            </form>
        </div>

        <div id="announcement-result"></div>

        <!-- ==================== IMPORTANT LINKS UPLOAD ==================== -->
<h4 class="mt-4">Add Important Link</h4>
<div class="card p-4 shadow-sm mb-5">
    <form id="importantLinkForm">

        <div class="mb-3">
            <label class="form-label">Link Title</label>
            <input type="text" class="form-control" name="title" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Link URL</label>
            <input type="url" class="form-control" name="url" required>
        </div>

        <button class="btn btn-success w-100" type="submit">
            Add Important Link
        </button>
    </form>
</div>

<div id="important-link-result"></div>


    </div>

<script>
    
const backendURL = "https://tsas-backend.onrender.com";

// ================= NOTICE UPLOAD =================
document.getElementById("noticeForm").addEventListener("submit", async e => {
    e.preventDefault();

    const formData = new FormData(e.target);

    const res = await fetch(`${backendURL}/api/notices/upload`, {
        method: "POST",
        body: formData
    });

    const data = await res.json();

    document.getElementById("notice-result").innerHTML = `
        <div class="alert alert-info mt-3">
            <pre>${JSON.stringify(data, null, 2)}</pre>
        </div>
    `;

    e.target.reset();
});

// ================= ANNOUNCEMENT UPLOAD =================
document.getElementById("announcementForm").addEventListener("submit", async e => {
    e.preventDefault();

    const formData = new FormData(e.target);

    const res = await fetch(`${backendURL}/api/announcements/upload`, {
        method: "POST",
        body: formData
    });

    const data = await res.json();

    document.getElementById("announcement-result").innerHTML = `
        <div class="alert alert-warning mt-3">
            <pre>${JSON.stringify(data, null, 2)}</pre>
        </div>
    `;

    e.target.reset();
});


// ================= IMPORTANT LINKS UPLOAD =================
const importantLinkForm = document.getElementById("importantLinkForm");

importantLinkForm.addEventListener("submit", async function (e) {
    e.preventDefault();

    const formData = new FormData(importantLinkForm);

    const data = {
        title: formData.get("title"),
        url: formData.get("url")
    };

    try {
        const res = await fetch(`${backendURL}/api/important-links`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
        });

        const result = await res.json();

        document.getElementById("important-link-result").innerHTML = `
            <div class="alert alert-success mt-3">
                <strong>Important Link Response:</strong><br>
                <pre>${JSON.stringify(result, null, 2)}</pre>
            </div>
        `;

        importantLinkForm.reset();

    } catch (error) {
        document.getElementById("important-link-result").innerHTML = `
            <div class="alert alert-danger mt-3">
                Error adding important link
            </div>
        `;
    }
});


</script>

</body>
</html>
